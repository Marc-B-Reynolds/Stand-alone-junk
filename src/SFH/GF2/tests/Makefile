# Dumb mini makefile:
# 0) assumes clang/GCC like options
# 1) every .c file is to be built into an executable

CC     = clang-15  # forcing compiler: temp hack

IDIRS  = -I../.. -I..
CFLAGS = -g -O3 ${IDIRS} -march=native -Wall -Wextra -Wconversion -Wpedantic -Wno-unused-function
LDLIBS = -lbmat -lm4ri

SRC     := ${wildcard *.c}
HEADERS := ${wildcard *.h}
TARGETS := ${SRC:.c=}

all:    ${TARGETS}

clean:
	-${RM} ${TARGETS}

distclean:	clean
	-${RM} .makedep *~

.makedep:
	@-echo "building dependencies"
	@-echo "# autogenerated by Makefile" > .makedep
	@$(foreach file, $(SRC), ${CC} ${IDIRS} -MM -MQ${file:.c=}  $(file) >> .makedep;)


%:%.c	Makefile
	${CC} ${CFLAGS} $< -L.. ${LDLIBS} -o $@

-include .makedep
